<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>3D Runner - Humanoid Player</title>
<style>
  body { margin:0; display:flex; align-items:center; justify-content:center; height:100vh; background:#0b1020; overflow:hidden; }
  canvas { border-radius:16px; box-shadow:0 8px 24px rgba(0,0,0,0.6); background:linear-gradient(180deg,#071127,#0b1020); }
</style>
</head>
<body>
<canvas id="game" width="400" height="640"></canvas>
<script>
const canvas=document.getElementById('game');
const ctx=canvas.getContext('2d');

let tick=0;
let running=true;
let player={x:canvas.width/2,bob:0,vx:0};
const roadWidth=200;
const maxSpeed=5;

// create a simple 3D humanoid sprite
function createHumanoidSprite(){
  const size=40;
  const c=document.createElement('canvas');
  c.width=size; c.height=size;
  const ctx=c.getContext('2d');

  // body
  const gradBody=ctx.createLinearGradient(0,size*0.25,0,size);
  gradBody.addColorStop(0,'#4cc79e');
  gradBody.addColorStop(1,'#2a7d5a');
  ctx.fillStyle=gradBody;
  ctx.fillRect(size*0.25,size*0.25,size*0.5,size*0.5);

  // head
  const gradHead=ctx.createLinearGradient(0,0,0,size*0.25);
  gradHead.addColorStop(0,'#ffd6a5');
  gradHead.addColorStop(1,'#e6b684');
  ctx.fillStyle=gradHead;
  ctx.fillRect(size*0.35,0,size*0.3,size*0.25);

  // legs
  ctx.fillStyle='#3ba37a';
  ctx.fillRect(size*0.25,size*0.75,size*0.15,size*0.25);
  ctx.fillRect(size*0.6,size*0.75,size*0.15,size*0.25);

  // arms
  ctx.fillRect(0.1*size,size*0.25,0.15*size,size*0.4);
  ctx.fillRect(0.75*size,size*0.25,0.15*size,size*0.4);

  const img=new Image();
  img.src=c.toDataURL();
  return img;
}

const playerImg=createHumanoidSprite();

function project(z){
  const scale=1/(z*0.003+0.2);
  const y=canvas.height - z*0.5;
  return {scale,y};
}

function drawRoad(){
  const segments=20;
  for(let i=0;i<segments;i++){
    const z=i*50;
    const {scale,y}=project(z);
    const w=roadWidth*scale;

    // road
    ctx.fillStyle='#444';
    ctx.beginPath();
    ctx.moveTo(canvas.width/2-w/2,y);
    ctx.lineTo(canvas.width/2+w/2,y);
    ctx.lineTo(canvas.width/2+w/2,y+50*scale);
    ctx.lineTo(canvas.width/2-w/2,y+50*scale);
    ctx.closePath();
    ctx.fill();

    // lane line
    if(i%2===0){
      ctx.strokeStyle='#fff';
      ctx.lineWidth=2*scale;
      ctx.setLineDash([10*scale,10*scale]);
      ctx.beginPath();
      ctx.moveTo(canvas.width/2,y+25*scale);
      ctx.lineTo(canvas.width/2,y+50*scale);
      ctx.stroke();
      ctx.setLineDash([]);
    }

    // road edges
    ctx.strokeStyle='#222';
    ctx.lineWidth=1*scale;
    ctx.strokeRect(canvas.width/2-w/2,y,w,50*scale);
  }
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  tick++;
  player.bob=Math.sin(tick*0.1)*5;

  drawRoad();

  const size=40;
  ctx.drawImage(playerImg,player.x-size/2,canvas.height-100+player.bob,size,size);
}

function update(){
  // smooth horizontal movement
  player.x+=player.vx;
  const halfRoad=roadWidth/2-20;
  if(player.x<canvas.width/2-halfRoad) player.x=canvas.width/2-halfRoad;
  if(player.x>canvas.width/2+halfRoad) player.x=canvas.width/2+halfRoad;
  player.vx*=0.9;
}

function loop(){
  if(!running) return;
  update();
  draw();
  requestAnimationFrame(loop);
}

// controls
const keys={};
window.addEventListener('keydown',e=>{keys[e.key]=true;});
window.addEventListener('keyup',e=>{keys[e.key]=false;});
function handleInput(){
  if(keys['ArrowLeft']) player.vx=-5;
  else if(keys['ArrowRight']) player.vx=5;
}
setInterval(handleInput,16);
loop();
</script>
</body>
</html>
