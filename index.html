<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>3D Runner - Smooth</title>
<style>
  body { margin:0; display:flex; align-items:center; justify-content:center; height:100vh; background:#0b1020; overflow:hidden; }
  canvas { border-radius:16px; box-shadow:0 8px 24px rgba(0,0,0,0.6); background:linear-gradient(180deg,#071127,#0b1020); }
</style>
</head>
<body>
<canvas id="game" width="400" height="640"></canvas>
<script>
const canvas=document.getElementById('game');
const ctx=canvas.getContext('2d');

let tick=0;
let running=true;
let player={x:canvas.width/2,bob:0,vx:0};
const roadWidth=200;
const maxSpeed=5;

// generate player pseudo-3D gradient cube
function createPlayerSprite(size=40){
  const c=document.createElement('canvas');
  c.width=size; c.height=size;
  const ctx=c.getContext('2d');
  // top face gradient
  const gradTop=ctx.createLinearGradient(0,0,size,0);
  gradTop.addColorStop(0,'#6ef0b1');
  gradTop.addColorStop(1,'#3ba37a');
  ctx.fillStyle=gradTop;
  ctx.beginPath();
  ctx.moveTo(size*0.25,0);
  ctx.lineTo(size*0.75,0);
  ctx.lineTo(size,size*0.25);
  ctx.lineTo(0,size*0.25);
  ctx.closePath();
  ctx.fill();
  // side face gradient
  const gradSide=ctx.createLinearGradient(size*0.75,0,size,size);
  gradSide.addColorStop(0,'#4cc79e');
  gradSide.addColorStop(1,'#2a7d5a');
  ctx.fillStyle=gradSide;
  ctx.beginPath();
  ctx.moveTo(size*0.75,0);
  ctx.lineTo(size,size*0.25);
  ctx.lineTo(size,size*0.75);
  ctx.lineTo(size*0.75,size);
  ctx.closePath();
  ctx.fill();
  // front face gradient
  const gradFront=ctx.createLinearGradient(0,size*0.25,0,size);
  gradFront.addColorStop(0,'#3ba37a');
  gradFront.addColorStop(1,'#1e5a3c');
  ctx.fillStyle=gradFront;
  ctx.fillRect(size*0.25,size*0.25,size*0.5,size*0.75);
  const img=new Image();
  img.src=c.toDataURL();
  return img;
}

const playerImg=createPlayerSprite();

// project function for perspective
function project(z){
  const scale=1/(z*0.003+0.2);
  const y=canvas.height - z*0.5;
  return {scale,y};
}

function drawRoad(){
  const segments=20;
  for(let i=0;i<segments;i++){
    const z=i*50;
    const {scale,y}=project(z);
    const w=roadWidth*scale;
    const grad=ctx.createLinearGradient(canvas.width/2-w/2,y,canvas.width/2+w/2,y+50*scale);
    grad.addColorStop(0,'#1a2a3a');
    grad.addColorStop(1,'#162135');
    ctx.fillStyle=grad;
    ctx.beginPath();
    ctx.moveTo(canvas.width/2-w/2,y);
    ctx.lineTo(canvas.width/2+w/2,y);
    ctx.lineTo(canvas.width/2+w/2,y+50*scale);
    ctx.lineTo(canvas.width/2-w/2,y+50*scale);
    ctx.closePath();
    ctx.fill();
  }
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  tick++;
  player.bob=Math.sin(tick*0.1)*5;

  drawRoad();

  const size=40;
  ctx.drawImage(playerImg,player.x-size/2,canvas.height-100+player.bob,size,size);
}

function update(){
  // smooth horizontal movement
  player.x+=player.vx;
  // clamp within road
  const halfRoad=roadWidth/2-20;
  if(player.x<canvas.width/2-halfRoad) player.x=canvas.width/2-halfRoad;
  if(player.x>canvas.width/2+halfRoad) player.x=canvas.width/2+halfRoad;
  // apply friction
  player.vx*=0.9;
}

function loop(){
  if(!running) return;
  update();
  draw();
  requestAnimationFrame(loop);
}

// controls
const keys={};
window.addEventListener('keydown',e=>{keys[e.key]=true;});
window.addEventListener('keyup',e=>{keys[e.key]=false;});
function handleInput(){
  if(keys['ArrowLeft']) player.vx=-maxSpeed;
  else if(keys['ArrowRight']) player.vx=maxSpeed;
}

setInterval(handleInput,16);
loop();
</script>
</body>
</html>
